Changes in component 'nf-core/samtools/depth'
'modules/nf-core/samtools/depth/meta.yml' is unchanged
Changes in 'samtools/depth/main.nf':
--- modules/nf-core/samtools/depth/main.nf
+++ modules/nf-core/samtools/depth/main.nf
@@ -8,11 +8,11 @@
         'biocontainers/samtools:1.21--h50ea8bc_0' }"
 
     input:
-    tuple val(meta1), path(bam)
-    tuple val(meta2), path(intervals)
+    tuple val(meta1), path(bam), path(bai)
+    tuple val(meta2), val(intervals)
 
     output:
-    tuple val(meta1), path("*.tsv"), emit: tsv
+    tuple val(meta1), path("*_samtools_depth/*.tsv"), emit: tsv
     path "versions.yml"           , emit: versions
 
     when:
@@ -20,16 +20,20 @@
 
     script:
     def args = task.ext.args ?: ''
-    def prefix = task.ext.prefix ?: "${meta1.id}"
-    def positions = intervals ? "-b ${intervals}" : ""
+    def sample_id = meta1.sample ?: meta1.id
+    def outdir = "${sample_id}_samtools_depth"
+    def cgcid = meta2.cgcid ?: meta2.id ?: meta2
+    def prefix = cgcid.replaceAll(/\|/, '-')
+    def positions = intervals ? "-r ${intervals}" : ""
     """
     # Note: --threads value represents *additional* CPUs to allocate (total CPUs = 1 + --threads).
+    mkdir -p ${outdir}
     samtools \\
         depth \\
         --threads ${task.cpus-1} \\
         $args \\
         $positions \\
-        -o ${prefix}.tsv \\
+        -o ${outdir}/${prefix}.tsv \\
         $bam
 
     cat <<-END_VERSIONS > versions.yml

'modules/nf-core/samtools/depth/environment.yml' is unchanged
'modules/nf-core/samtools/depth/tests/main.nf.test' is unchanged
'modules/nf-core/samtools/depth/tests/main.nf.test.snap' is unchanged
************************************************************
